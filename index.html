<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<style>
		img {
			max-width: 100%;
		}
		.roulet * {
			box-sizing: border-box;
		}
		.roulet__form,
		.roulet__col {
			position: relative;
			width: 500px;
			height: 650px;
			transition: all 2s;
		}
		body {
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.roulet__wrap {
			position: relative;
		}
		.roulet__empty {
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			transition: opacity 1s;
			border-radius: 50%;
			overflow: hidden;
		}
		.slow__rotation {
			animation: slow-rotation 10s linear infinite;
		}
		@keyframes slow-rotation {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .fast-clockwise {
            animation: fast-clockwise 3s cubic-bezier(.52,-0.6,.12,.98);
        }
        
        @keyframes fast-clockwise {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(720deg);
            }
        }
        .fade {
        	opacity: 0;
        }
        .btn {
        	background-color: rgb(33, 110, 52);
        	color: #fff;
        	display: block;
        	margin-left: auto;
        	margin-right: auto;
        	width: 300px;
        	padding: 18px;
        	border-radius: 4px;
        	border: none;
        	margin-top: 16px;
        	cursor: pointer;
        }
        .roulet {
        	display: flex;
        	font-family: sans-serif;
        	gap: 10px;
        }
        .roulet__wrap,
        .roulet__empty {
        	width: 500px;
        	height: 500px;
        }
        .roulet__success,
        .roulet__title {
        	text-align: center;
        	font-size: 32px;
        }
        .roulet__desc {
        	font-size: 18px;
        	margin-top: 16px;
        	text-align: center;
        	margin-bottom: 32px;
        }
        .input__wrap {
        	display: block;
        	width: 100%;
        	margin-top: 8px;
        }
        .input__wrap input {
        	border: 1px solid #ddd;
        	padding: 10px;
        	border-radius: 4px;
        	width: 300px;
        	display: block;
        	margin-left: auto;
        	margin-right: auto;
        	font-size: 16px;
        }
        .roulet__form {
        	display: flex;
        	align-items: center;
        	flex-direction: column;
        	justify-content: center;
        }
        .roulet__col {
        	position: relative;
        	left: 255px;
        	z-index: 2;
        	background-color: #fff;
        	display: flex;
        	align-items: center;
        }
        .roulet__form {
        	left: -255px;
        	z-index: 1;
        }
        .roulet__outer {
        	position: relative;
        	display: flex;
        	flex-direction: column;
        	justify-content: center;
        	align-items: center;
        }
        .logo {
        	position: absolute;
        	z-index: 2;
        	left: calc(50% - 32px);
        	top: calc(50% - 64px);
        	width: 64px;
        	height: 64px;
        	background-color: #fff;
        	border-radius: 50%;
        	border: 1px solid #0a0;
        	animation: slow-rotation 15s linear infinite;
        }
        
        @media screen and (max-width: 1100px) {
        	.roulet__form,
			.roulet__col {
				width: 300px;
			}
			.roulet__col {
				left: 155px;
			}
			.roulet__form {
	        	left: -155px;
	        }
	        .roulet__wrap,
	        .roulet__empty {
	        	width: 300px;
	        	height: 300px;
	        }
        }
        @media screen and (max-width: 768px) {
        	.roulet {
        		flex-wrap: wrap;
        		height: 500px;
        		transition: all 2s;
        	}
        	.roulet__form,
        	.roulet__col {
        		width: 100%;
        	}
        	.roulet__col {
        		justify-content: center;
				left: 0;
				height: 430px;
			}
			.roulet__form {
	        	left: 0;
	        	height: auto;
	        	top: -430px;
	        }
	        .roulet--end {
	        	height: 670px;
	        }
        }
        .roulet__default {
        	left: 0;
        	top: 0;
        }
        .hide {
        	opacity: 0;
        	visibility: hidden;
        }
        .triangle {
		   display: inline-block;
		      width: 0;
		      height: 0;
		      border-style: solid;
		    border-width: 50px 86.6px 50px 0px;
		    border-color: transparent #198A37 transparent transparent;
		    position: absolute;
		    right: -50px;
		    top: calc(50% - 81px);
		}

		@media screen and (max-width: 768px) {
			.triangle {
				border-width: 20px 56.6px 20px 0px;
				right: -15px;
				top: calc(50% - 52px);
			}
			
		}
		.show {
			display: block;
		}
		.hide {
			display: none;

		}


	</style>	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/imask/7.6.1/imask.min.js" integrity="sha512-+3RJc0aLDkj0plGNnrqlTwCCyMmDCV1fSYqXw4m+OczX09Pas5A/U+V3pFwrSyoC1svzDy40Q9RU/85yb/7D2A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
	<div class="roulet">
		<div class="roulet__col">
			<div class="roulet__outer">
				<div class="roulet__wrap">
					<img src="./win1.png" alt="">
				</div>
				<div class="roulet__empty slow__rotation" id="rotating-image">
					<img src="https://caof19.github.io/spa-roulet/empty.png" alt="">
				</div>
				<div class="logo">
					<img src="https://caof19.github.io/spa-roulet/logo.png" alt="">
				</div>
				<div class="triangle"></div>
				<button id="spin-button" class="btn">Крути колесо и получи приз!</button>
			</div>
		</div>
		<div class="roulet__form">
			<div class="roulet__frm">
				<div class="roulet__title">ВЫИГРАЙТЕ ОДИН <br> ИЗ ПРИЗОВ</div>
				<div class="roulet__desc">Введите свои контактные данные, вращайте <br> колесо и получите подарок</div>
				<form action="" class="form" id="myForm">
					<label for="" class="input__wrap">
						<input type="text" placeholder="Ваше имя" name="name">
					</label>
					<label for="" class="input__wrap">
						<input type="text" placeholder="+7 (999) 999-99-99" id="phone-mask" name="phone">
					</label>
					<label for="" class="input__wrap">
						<input type="text" placeholder="Ваш E-mail" name="email">
					</label>
					<input type="hidden" name="win">
					<button class="btn">Получить подарок</button>
				</form>
			</div>
			<div class="roulet__success hide">
				Наш менеджер <br> свяжется с вами!
			</div>
		</div>
	</div>
	<script>
		document.addEventListener('DOMContentLoaded', function(){

			IMask(
			  document.getElementById('phone-mask'),
			  {
			    mask: '+{7}(000)000-00-00'
			  }
			)

			const active = localStorage.getItem('giftImg');
			const image = document.getElementById('rotating-image');
	        const spinButton = document.getElementById('spin-button');
	        const giftSpin = document.querySelector('.roulet__wrap img');
			
			if(active) {
				giftSpin.setAttribute('src', active)
				image.classList.remove('fast-clockwise');
				image.classList.remove('slow__rotation');
				image.classList.add('fade');
				spinButton.style.opacity = 0;
				document.querySelector('.roulet__col').classList.add('roulet__default');
                document.querySelector('.roulet__form').classList.add('roulet__default');
                document.querySelector('.roulet').classList.add('roulet--end');
                document.querySelector('.roulet__frm').classList.add('hide');
                document.querySelector('.roulet__success').classList.remove('hide');
                return;
			}

	        
	        spinButton.addEventListener('click', function() {
	            const randomNumber = Math.floor(Math.random() * 100) + 1;
	            image.classList.remove('slow__rotation');
	            image.classList.add('fast-clockwise');
	            spinButton.style.opacity = 0;
	            const activeGift = chance.find(item => {
	            	return randomNumber >= item.min && randomNumber <= item.max
	            })

            	document.querySelector('[name="win"]').value = activeGift.name;

	            giftSpin.setAttribute('src', activeGift.img)
	            localStorage.setItem('giftImg', activeGift.img)

	            setTimeout(() => {
	                image.classList.remove('fast-clockwise');
	                image.classList.add('fade');

	                document.querySelector('.roulet__col').classList.add('roulet__default');
	                document.querySelector('.roulet__form').classList.add('roulet__default');
	                document.querySelector('.roulet').classList.add('roulet--end');
	            }, 3000);
	        });

	        let chance = [
	        	{
	        		img: 'https://caof19.github.io/spa-roulet/win2.png',
	        		min: 0,
	        		max: 9,
	        		name: 'Скидка 5%',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win3.png',
	        		min: 10,
	        		max: 44,
	        		name: 'Скидка 7%',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win4.png',
	        		min: 45,
	        		max: 70,
	        		name: 'Скидка 300₽',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win5.png',
	        		min: 71,
	        		max: 76,
	        		name: 'Стоунтерапия',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win6.png',
	        		min: 77,
	        		max: 82,
	        		name: 'Парафин рук',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win7.png',
	        		min: 83,
	        		max: 87,
	        		name: 'Массаж лица',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win8.png',
	        		min: 88,
	        		max: 90,
	        		name: 'Уход за лицом',
	        	},{
	        		img: 'https://caof19.github.io/spa-roulet/win9.png',
	        		min: 91,
	        		max: 100,
	        		name: 'Скидка 500₽',
	        	}
	        ];

	        document.getElementById('myForm').addEventListener('submit', function(e) {
	            e.preventDefault(); 
	            
	            const formData = new FormData(this);
	            
	            
	            const data = {};
	            formData.forEach((value, key) => {
	                data[key] = value;
	            });
	            
	            document.cookie = "beget=begetok; path=/";
	            fetch('https://sam.panfolio.ru/roulet.php', {
	                method: 'POST',
	                // headers: {
	                //     'Content-Type': 'application/json', // Указываем, что отправляем JSON
	                // },
	                body:formData // Преобразуем объект в JSON-строку
	            })
	            .then(response => {
	              	document.querySelector('.roulet__frm').classList.add('hide');
                	document.querySelector('.roulet__success').classList.remove('hide');	                  
	            })
	        })
	    })
    </script>

</body>
</html>